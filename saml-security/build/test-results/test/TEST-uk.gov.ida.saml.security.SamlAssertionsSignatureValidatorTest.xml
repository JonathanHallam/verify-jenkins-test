<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="uk.gov.ida.saml.security.SamlAssertionsSignatureValidatorTest" tests="3" skipped="0" failures="0" errors="0" timestamp="2018-04-03T13:58:09" hostname="gds8080.local" time="0.068">
  <properties/>
  <testcase name="shouldValidateAllAssertions" classname="uk.gov.ida.saml.security.SamlAssertionsSignatureValidatorTest" time="0.04"/>
  <testcase name="shouldFailOnFirstBadlySignedAssertion" classname="uk.gov.ida.saml.security.SamlAssertionsSignatureValidatorTest" time="0.008"/>
  <testcase name="shouldFailOnAssertionSignedWithWrongIssuer" classname="uk.gov.ida.saml.security.SamlAssertionsSignatureValidatorTest" time="0.019"/>
  <system-out><![CDATA[14:58:09.669 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.669 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.670 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.670 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" class "class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256"
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.670 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2000/09/xmldsig#enveloped-signature" class "class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature"
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2001/10/xml-exc-c14n#" class "class org.apache.xml.security.transforms.implementations.TransformC14NExclusive"
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.670 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.670 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.670 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.671 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.671 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.671 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ec:InclusiveNamespaces", "null")
14:58:09.672 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.672 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:ida="http://www.cabinetoffice.gov.uk/resource-library/ida/attributes" xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.665Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>a-test-entity</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.665Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions><saml2:AttributeStatement xsi:type="saml2:AttributeStatementType"><saml2:Attribute FriendlyName="IPAddress" Name="TXN_IPaddress" xsi:type="saml2:AttributeType"><saml2:AttributeValue ida:Verified="false" xsi:type="ida:IPAddressType">1.2.3.4</saml2:AttributeValue></saml2:Attribute></saml2:AttributeStatement><saml2:AuthnStatement xsi:type="saml2:AuthnStatementType"><saml2:AuthnContext><saml2:AuthnContextClassRef>urn:uk:gov:cabinet-office:tc:saml:authn-context:level2</saml2:AuthnContextClassRef></saml2:AuthnContext></saml2:AuthnStatement></saml2:Assertion>
14:58:09.672 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.672 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"><ec:InclusiveNamespaces xmlns:ec="http://www.w3.org/2001/10/xml-exc-c14n#" PrefixList="ida"></ec:InclusiveNamespaces></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>1jgxHuSMU5u1ANK+74NsB8sfYagGxVRL0zHLeZiUKQw=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.676 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.676 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.676 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.676 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" class "class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256"
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.677 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2000/09/xmldsig#enveloped-signature" class "class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature"
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2001/10/xml-exc-c14n#" class "class org.apache.xml.security.transforms.implementations.TransformC14NExclusive"
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.677 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.677 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.677 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.677 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.676Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>a-test-entity</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.676Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions></saml2:Assertion>
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.677 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>z4y4O/FM6s5mO41Srjz3A7O8X8grcBhWL7G437hUKqI=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.693 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.693 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.693 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.693 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.693 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.693 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.693 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.693 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.693 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.693 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.694 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 29661565466865858822213777168282943426939714058048863814131618959262055326686524034067084771065231712149539921346081944346397936363399690100840608397845307756315334022317517219876633006263454147272155286336727606522796880921103550938022720211151696581738939213739476141952593191308436813042936252687545137035166455002660478121017225183474993112090021369737861768882984387493729935697205880819466743626280109454603687587536282588576195647432312509500999623830562445007026743026958608467395710329014740842807769757806142655188427663764629833308992121291511482553904626598854250168151827151971234837768337295616595808239
  public exponent: 65537
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"><ec:InclusiveNamespaces xmlns:ec="http://www.w3.org/2001/10/xml-exc-c14n#" PrefixList="ida"></ec:InclusiveNamespaces></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>1jgxHuSMU5u1ANK+74NsB8sfYagGxVRL0zHLeZiUKQw=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - verify 1 References
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - I am not requested to follow nested Manifests
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Reference", "null")
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transforms", "null")
14:58:09.694 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ec:InclusiveNamespaces", "null")
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:ida="http://www.cabinetoffice.gov.uk/resource-library/ida/attributes" xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.665Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>a-test-entity</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.665Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions><saml2:AttributeStatement xsi:type="saml2:AttributeStatementType"><saml2:Attribute FriendlyName="IPAddress" Name="TXN_IPaddress" xsi:type="saml2:AttributeType"><saml2:AttributeValue ida:Verified="false" xsi:type="ida:IPAddressType">1.2.3.4</saml2:AttributeValue></saml2:Attribute></saml2:AttributeStatement><saml2:AuthnStatement xsi:type="saml2:AuthnStatementType"><saml2:AuthnContext><saml2:AuthnContextClassRef>urn:uk:gov:cabinet-office:tc:saml:authn-context:level2</saml2:AuthnContextClassRef></saml2:AuthnContext></saml2:AuthnStatement></saml2:Assertion>
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.signature.Reference - Verification successful for URI "#some-assertion-id"
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - The Reference has Type 
14:58:09.695 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature validated with key from supplied credential
14:58:09.695 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate credential was successful
14:58:09.695 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Successfully verified signature using resolved trusted credential
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.695 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.695 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.695 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.695 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.695 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.695 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.695 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.696 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 29661565466865858822213777168282943426939714058048863814131618959262055326686524034067084771065231712149539921346081944346397936363399690100840608397845307756315334022317517219876633006263454147272155286336727606522796880921103550938022720211151696581738939213739476141952593191308436813042936252687545137035166455002660478121017225183474993112090021369737861768882984387493729935697205880819466743626280109454603687587536282588576195647432312509500999623830562445007026743026958608467395710329014740842807769757806142655188427663764629833308992121291511482553904626598854250168151827151971234837768337295616595808239
  public exponent: 65537
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>z4y4O/FM6s5mO41Srjz3A7O8X8grcBhWL7G437hUKqI=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - verify 1 References
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - I am not requested to follow nested Manifests
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Reference", "null")
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transforms", "null")
14:58:09.696 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.676Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>a-test-entity</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.676Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions></saml2:Assertion>
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.signature.Reference - Verification successful for URI "#some-assertion-id"
14:58:09.697 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - The Reference has Type 
14:58:09.697 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature validated with key from supplied credential
14:58:09.697 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate credential was successful
14:58:09.697 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Successfully verified signature using resolved trusted credential
14:58:09.702 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.702 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.702 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.703 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" class "class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256"
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.703 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2000/09/xmldsig#enveloped-signature" class "class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature"
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2001/10/xml-exc-c14n#" class "class org.apache.xml.security.transforms.implementations.TransformC14NExclusive"
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.703 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.703 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.703 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.704 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.704 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.704 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.704 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" class "class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256"
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.704 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2000/09/xmldsig#enveloped-signature" class "class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature"
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2001/10/xml-exc-c14n#" class "class org.apache.xml.security.transforms.implementations.TransformC14NExclusive"
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.704 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.704 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.704 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.705 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.705 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ec:InclusiveNamespaces", "null")
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:ida="http://www.cabinetoffice.gov.uk/resource-library/ida/attributes" xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.704Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>a-test-entity</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.703Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions><saml2:AttributeStatement xsi:type="saml2:AttributeStatementType"><saml2:Attribute FriendlyName="IPAddress" Name="TXN_IPaddress" xsi:type="saml2:AttributeType"><saml2:AttributeValue ida:Verified="false" xsi:type="ida:IPAddressType">1.2.3.4</saml2:AttributeValue></saml2:Attribute></saml2:AttributeStatement><saml2:AuthnStatement xsi:type="saml2:AuthnStatementType"><saml2:AuthnContext><saml2:AuthnContextClassRef>urn:uk:gov:cabinet-office:tc:saml:authn-context:level2</saml2:AuthnContextClassRef></saml2:AuthnContext></saml2:AuthnStatement></saml2:Assertion>
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.705 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"><ec:InclusiveNamespaces xmlns:ec="http://www.w3.org/2001/10/xml-exc-c14n#" PrefixList="ida"></ec:InclusiveNamespaces></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>H5kA8hdGd+CpdDuqyfA7zn7iW6mP873sA0mawvxZ1OQ=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.711 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.711 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.711 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.711 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" class "class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256"
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.711 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2000/09/xmldsig#enveloped-signature" class "class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature"
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2001/10/xml-exc-c14n#" class "class org.apache.xml.security.transforms.implementations.TransformC14NExclusive"
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.711 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.711 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.711 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.712 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.712 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ec:InclusiveNamespaces", "null")
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.712 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:ida="http://www.cabinetoffice.gov.uk/resource-library/ida/attributes" xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.710Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>a-test-entity</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.710Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions><saml2:AttributeStatement xsi:type="saml2:AttributeStatementType"><saml2:Attribute FriendlyName="IPAddress" Name="TXN_IPaddress" xsi:type="saml2:AttributeType"><saml2:AttributeValue ida:Verified="false" xsi:type="ida:IPAddressType">1.2.3.4</saml2:AttributeValue></saml2:Attribute></saml2:AttributeStatement><saml2:AuthnStatement xsi:type="saml2:AuthnStatementType"><saml2:AuthnContext><saml2:AuthnContextClassRef>urn:uk:gov:cabinet-office:tc:saml:authn-context:level2</saml2:AuthnContextClassRef></saml2:AuthnContext></saml2:AuthnStatement></saml2:Assertion>
14:58:09.713 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.713 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"><ec:InclusiveNamespaces xmlns:ec="http://www.w3.org/2001/10/xml-exc-c14n#" PrefixList="ida"></ec:InclusiveNamespaces></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>ddbSgtnYAOr68zMhyIN2lggSZpBLetaVuI37pPg6HBo=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.717 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.717 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.717 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.717 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.717 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.717 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.717 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.717 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.717 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 29661565466865858822213777168282943426939714058048863814131618959262055326686524034067084771065231712149539921346081944346397936363399690100840608397845307756315334022317517219876633006263454147272155286336727606522796880921103550938022720211151696581738939213739476141952593191308436813042936252687545137035166455002660478121017225183474993112090021369737861768882984387493729935697205880819466743626280109454603687587536282588576195647432312509500999623830562445007026743026958608467395710329014740842807769757806142655188427663764629833308992121291511482553904626598854250168151827151971234837768337295616595808239
  public exponent: 65537
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"><ec:InclusiveNamespaces xmlns:ec="http://www.w3.org/2001/10/xml-exc-c14n#" PrefixList="ida"></ec:InclusiveNamespaces></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>ddbSgtnYAOr68zMhyIN2lggSZpBLetaVuI37pPg6HBo=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - verify 1 References
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - I am not requested to follow nested Manifests
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Reference", "null")
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transforms", "null")
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ec:InclusiveNamespaces", "null")
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:ida="http://www.cabinetoffice.gov.uk/resource-library/ida/attributes" xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.710Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>a-test-entity</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.710Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions><saml2:AttributeStatement xsi:type="saml2:AttributeStatementType"><saml2:Attribute FriendlyName="IPAddress" Name="TXN_IPaddress" xsi:type="saml2:AttributeType"><saml2:AttributeValue ida:Verified="false" xsi:type="ida:IPAddressType">1.2.3.4</saml2:AttributeValue></saml2:Attribute></saml2:AttributeStatement><saml2:AuthnStatement xsi:type="saml2:AuthnStatementType"><saml2:AuthnContext><saml2:AuthnContextClassRef>urn:uk:gov:cabinet-office:tc:saml:authn-context:level2</saml2:AuthnContextClassRef></saml2:AuthnContext></saml2:AuthnStatement></saml2:Assertion>
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.signature.Reference - Verification successful for URI "#some-assertion-id"
14:58:09.718 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - The Reference has Type 
14:58:09.718 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature validated with key from supplied credential
14:58:09.719 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate credential was successful
14:58:09.719 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Successfully verified signature using resolved trusted credential
14:58:09.719 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.719 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.719 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.719 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256" class "class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256"
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.719 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2000/09/xmldsig#enveloped-signature" class "class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature"
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI "http://www.w3.org/2001/10/xml-exc-c14n#" class "class org.apache.xml.security.transforms.implementations.TransformC14NExclusive"
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.719 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.719 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.720 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.720 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.720 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: "#some-assertion-id"
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - <saml2:Assertion xmlns:saml2="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ID="some-assertion-id" IssueInstant="2018-04-03T13:58:09.719Z" Version="2.0" xsi:type="saml2:AssertionType"><saml2:Issuer>https://signin.service.gov.uk</saml2:Issuer><saml2:Subject xsi:type="saml2:SubjectType"><saml2:NameID Format="urn:oasis:names:tc:SAML:2.0:nameid-format:persistent"></saml2:NameID><saml2:SubjectConfirmation Method="urn:oasis:names:tc:SAML:2.0:cm:bearer" xsi:type="saml2:SubjectConfirmationType"><saml2:SubjectConfirmationData InResponseTo="default-request-id" NotOnOrAfter="2018-04-03T14:13:09.719Z" Recipient="https://signin.service.gov.uk" xsi:type="saml2:SubjectConfirmationDataType"></saml2:SubjectConfirmationData></saml2:SubjectConfirmation></saml2:Subject><saml2:Conditions xsi:type="saml2:ConditionsType"><saml2:AudienceRestriction xsi:type="saml2:AudienceRestrictionType"><saml2:Audience>https://signin.service.gov.uk</saml2:Audience></saml2:AudienceRestriction></saml2:Conditions></saml2:Assertion>
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.720 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>pifVrL/Sd9dKvV4lLX7TNZ1PkzJ09dmEbSaJlC0N0PU=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.725 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.725 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.725 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement("ds:Transform", "null")
14:58:09.725 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.725 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.725 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.725 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.725 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.725 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 25998853806074907922736536937144192810524126200249845203941498583957653002742012081024851371701765572997964410773213417627351163207763916839110493186842727422105108695847327425148517951272422220366166787137233228070807559064518855586460848701406111149789270506162893565711430566183449983164245901187970559589037577615433138971451632097660130400984021863805390812022721378617499178820332971373486312850645816708350643062789774826141511451391051956832621350686324922826347973370110492133155768037641842259670336438666133242469461046538870604952985498558023280525040790594650803517622806143906741297205357832508919936977
  public exponent: 65537
14:58:09.725 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.726 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - <ds:SignedInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
<ds:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:CanonicalizationMethod>
<ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"></ds:SignatureMethod>
<ds:Reference URI="#some-assertion-id">
<ds:Transforms>
<ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"></ds:Transform>
<ds:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"></ds:Transform>
</ds:Transforms>
<ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"></ds:DigestMethod>
<ds:DigestValue>pifVrL/Sd9dKvV4lLX7TNZ1PkzJ09dmEbSaJlC0N0PU=</ds:DigestValue>
</ds:Reference>
</ds:SignedInfo>
14:58:09.726 [Test worker] WARN org.apache.xml.security.signature.XMLSignature - Signature verification failed.
14:58:09.726 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature cryptographic validation not successful
14:58:09.726 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate validation credential failed
org.opensaml.xmlsec.signature.support.SignatureException: Signature cryptographic validation not successful
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:79)
	at org.opensaml.xmlsec.signature.support.SignatureValidator.validate(SignatureValidator.java:54)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.verifySignature(BaseSignatureTrustEngine.java:242)
	at org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine.doValidate(ExplicitKeySignatureTrustEngine.java:119)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:105)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:62)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:48)
	at uk.gov.ida.saml.security.SamlMessageSignatureValidator.validateWithIssuer(SamlMessageSignatureValidator.java:67)
	at uk.gov.ida.saml.security.SamlMessageSignatureValidator.validateWithIssuer(SamlMessageSignatureValidator.java:56)
	at uk.gov.ida.saml.security.SamlMessageSignatureValidator.validate(SamlMessageSignatureValidator.java:37)
	at uk.gov.ida.saml.security.SamlMessageSignatureValidator$$EnhancerByMockitoWithCGLIB$$32b48489.CGLIB$validate$2(<generated>)
	at uk.gov.ida.saml.security.SamlMessageSignatureValidator$$EnhancerByMockitoWithCGLIB$$32b48489$$FastClassByMockitoWithCGLIB$$65f3a031.invoke(<generated>)
	at org.mockito.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:216)
	at org.mockito.internal.creation.AbstractMockitoMethodProxy.invokeSuper(AbstractMockitoMethodProxy.java:10)
	at org.mockito.internal.invocation.realmethod.CGLIBProxyRealMethod.invoke(CGLIBProxyRealMethod.java:22)
	at org.mockito.internal.invocation.realmethod.FilteredCGLIBProxyRealMethod.invoke(FilteredCGLIBProxyRealMethod.java:27)
	at org.mockito.internal.invocation.InvocationImpl.callRealMethod(InvocationImpl.java:108)
	at org.mockito.internal.stubbing.answers.CallsRealMethods.answer(CallsRealMethods.java:36)
	at org.mockito.internal.handler.MockHandlerImpl.handle(MockHandlerImpl.java:93)
	at org.mockito.internal.handler.NullResultGuardian.handle(NullResultGuardian.java:29)
	at org.mockito.internal.handler.InvocationNotifierHandler.handle(InvocationNotifierHandler.java:38)
	at org.mockito.internal.creation.MethodInterceptorFilter.intercept(MethodInterceptorFilter.java:51)
	at uk.gov.ida.saml.security.SamlMessageSignatureValidator$$EnhancerByMockitoWithCGLIB$$32b48489.validate(<generated>)
	at uk.gov.ida.saml.security.SamlAssertionsSignatureValidatorTest.shouldFailOnAssertionSignedWithWrongIssuer(SamlAssertionsSignatureValidatorTest.java:85)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
14:58:09.726 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Failed to verify signature using either KeyInfo-derived or directly trusted credentials
]]></system-out>
  <system-err><![CDATA[]]></system-err>
</testsuite>
