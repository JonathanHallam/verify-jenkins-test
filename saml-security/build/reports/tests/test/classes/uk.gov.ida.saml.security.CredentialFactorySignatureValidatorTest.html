<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"/>
<title>Test results - Class uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest</title>
<link href="../css/base-style.css" rel="stylesheet" type="text/css"/>
<link href="../css/style.css" rel="stylesheet" type="text/css"/>
<script src="../js/report.js" type="text/javascript"></script>
</head>
<body>
<div id="content">
<h1>Class uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest</h1>
<div class="breadcrumbs">
<a href="../index.html">all</a> &gt; 
<a href="../packages/uk.gov.ida.saml.security.html">uk.gov.ida.saml.security</a> &gt; CredentialFactorySignatureValidatorTest</div>
<div id="summary">
<table>
<tr>
<td>
<div class="summaryGroup">
<table>
<tr>
<td>
<div class="infoBox" id="tests">
<div class="counter">16</div>
<p>tests</p>
</div>
</td>
<td>
<div class="infoBox" id="failures">
<div class="counter">0</div>
<p>failures</p>
</div>
</td>
<td>
<div class="infoBox" id="ignored">
<div class="counter">0</div>
<p>ignored</p>
</div>
</td>
<td>
<div class="infoBox" id="duration">
<div class="counter">0.160s</div>
<p>duration</p>
</div>
</td>
</tr>
</table>
</div>
</td>
<td>
<div class="infoBox success" id="successRate">
<div class="percent">100%</div>
<p>successful</p>
</div>
</td>
</tr>
</table>
</div>
<div id="tabs">
<ul class="tabLinks">
<li>
<a href="#tab0">Tests</a>
</li>
<li>
<a href="#tab1">Standard output</a>
</li>
</ul>
<div id="tab0" class="tab">
<h2>Tests</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Duration</th>
<th>Result</th>
</tr>
</thead>
<tr>
<td class="success">shouldAcceptSignedAssertions</td>
<td>0.012s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotAcceptMissignedAssertions</td>
<td>0.008s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotAcceptUnsignedAssertions</td>
<td>0.007s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateBadSignatureAlgorithm</td>
<td>0.045s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateMissingSignature</td>
<td>0.003s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureBadReferenceURI</td>
<td>0.004s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureContainingObject</td>
<td>0.004s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureInvalidEnvelopeTransform</td>
<td>0.004s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureNoEnvelopeTransform</td>
<td>0.004s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureNoParentID</td>
<td>0.004s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureNoTransforms</td>
<td>0.006s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureNotImmediateChild</td>
<td>0.005s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureReferenceURINotParentID</td>
<td>0.004s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureTooManyReferences</td>
<td>0.004s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldNotValidateSignatureTooManyTransforms</td>
<td>0.013s</td>
<td class="success">passed</td>
</tr>
<tr>
<td class="success">shouldSupportAnEntityWithMultipleSigningCertificates</td>
<td>0.033s</td>
<td class="success">passed</td>
</tr>
</table>
</div>
<div id="tab1" class="tab">
<h2>Standard output</h2>
<span class="code">
<pre>14:58:08.975 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:08.975 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:08.975 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:08.975 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:08.975 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:08.975 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:08.976 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:08.976 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:08.976 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:08.976 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:08.976 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:08.978 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:08.978 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:08.978 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Invalid number of Transforms was present: 3
14:58:08.982 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute ID
14:58:08.982 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:08.982 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:08.982 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:08.982 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:08.982 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:08.982 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:08.982 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:08.982 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:08.982 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:08.982 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:08.982 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:08.983 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:08.983 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:08.983 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Reference URI '#_af01d14f-14db-46b9-b3f7-d9d67bff7e97' did not point to SignableSAMLObject with ID '_af01d14f-14db-46b9-b3f7-d9d67bff7e96'
14:58:08.987 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:08.987 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:08.987 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:08.987 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:08.987 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:08.987 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:08.988 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:08.988 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:08.988 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:08.988 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:08.988 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:08.988 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:08.988 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:08.988 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Apache XML Security exception obtaining Reference
org.apache.xml.security.transforms.TransformationException: Cannot find Transform in Transforms
	at org.apache.xml.security.transforms.Transforms.&lt;init&gt;(Transforms.java:143)
	at org.apache.xml.security.signature.Reference.&lt;init&gt;(Reference.java:239)
	at org.apache.xml.security.signature.Manifest.item(Manifest.java:229)
	at org.opensaml.saml.security.impl.SAMLSignatureProfileValidator.validateReference(SAMLSignatureProfileValidator.java:116)
	at org.opensaml.saml.security.impl.SAMLSignatureProfileValidator.validateSignatureImpl(SAMLSignatureProfileValidator.java:88)
	at org.opensaml.saml.security.impl.SAMLSignatureProfileValidator.validate(SAMLSignatureProfileValidator.java:64)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:29)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.validateAuthnRequestFile(CredentialFactorySignatureValidatorTest.java:177)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.shouldNotValidateSignatureNoTransforms(CredentialFactorySignatureValidatorTest.java:138)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:19)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
14:58:08.994 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:08.994 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:08.994 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:08.994 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:08.994 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:08.994 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:08.994 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:08.994 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:08.994 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:08.994 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown child element Wrapper
14:58:08.994 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:08.994 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:08.998 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:08.998 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:08.998 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:08.998 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:08.998 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:08.998 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:08.998 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:08.998 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:08.998 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:08.998 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:08.998 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:08.999 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:08.999 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:08.999 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Reference URI '#_af01d14f-14db-46b9-b3f7-d9d67bff7e97' did not point to SignableSAMLObject with ID '_af01d14f-14db-46b9-b3f7-d9d67bff7e96'
14:58:09.002 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:09.003 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-md5&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSAMD5&quot;
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-md5
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using MD5withRSA
14:58:09.003 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:09.003 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:09.003 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;&quot;)
14:58:09.003 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.003 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;&quot;)
14:58:09.003 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.010 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.011 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-md5
14:58:09.011 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-md5, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.011 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.011 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-md5
14:58:09.011 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.011 [Test worker] WARN org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm failed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-md5
14:58:09.012 [Test worker] WARN org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - XML signature failed algorithm whitelist/blacklist validation
14:58:09.045 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.045 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.046 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.046 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256&quot;
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.046 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature&quot;
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformC14NExclusive&quot;
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.046 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.046 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.047 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.047 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.047 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.047 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.047 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.048 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.049 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.049 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.049 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.049 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.049 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.049 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.049 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.050 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.050 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 25998853806074907922736536937144192810524126200249845203941498583957653002742012081024851371701765572997964410773213417627351163207763916839110493186842727422105108695847327425148517951272422220366166787137233228070807559064518855586460848701406111149789270506162893565711430566183449983164245901187970559589037577615433138971451632097660130400984021863805390812022721378617499178820332971373486312850645816708350643062789774826141511451391051956832621350686324922826347973370110492133155768037641842259670336438666133242469461046538870604952985498558023280525040790594650803517622806143906741297205357832508919936977
  public exponent: 65537
14:58:09.050 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.050 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.051 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate validation credential failed
org.opensaml.xmlsec.signature.support.SignatureException: Unable to evaluate key against signature
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:75)
	at org.opensaml.xmlsec.signature.support.SignatureValidator.validate(SignatureValidator.java:54)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.verifySignature(BaseSignatureTrustEngine.java:242)
	at org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine.doValidate(ExplicitKeySignatureTrustEngine.java:119)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:105)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:62)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:48)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.shouldNotAcceptUnsignedAssertions(CredentialFactorySignatureValidatorTest.java:44)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.xml.security.signature.XMLSignatureException: Signature length not correct: got 0 but was expecting 256
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:92)
	at org.apache.xml.security.algorithms.SignatureAlgorithm.verify(SignatureAlgorithm.java:301)
	at org.apache.xml.security.signature.XMLSignature.checkSignatureValue(XMLSignature.java:759)
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:70)
	... 55 common frames omitted
Caused by: java.security.SignatureException: Signature length not correct: got 0 but was expecting 256
	at sun.security.rsa.RSASignature.engineVerify(RSASignature.java:189)
	at java.security.Signature$Delegate.engineVerify(Signature.java:1223)
	at java.security.Signature.verify(Signature.java:656)
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:90)
	... 58 common frames omitted
14:58:09.051 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Failed to verify signature using either KeyInfo-derived or directly trusted credentials
14:58:09.054 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.054 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.054 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.054 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.054 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256&quot;
14:58:09.054 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.054 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.054 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.054 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature&quot;
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformC14NExclusive&quot;
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.055 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.055 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.055 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.055 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.055 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.053Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.052Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.056 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;GHtdQZgXMcB7FhYuBxHtpT4zMh1MgjH/Tr16nGjxaN8=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.061 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.061 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.061 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.061 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.062 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.062 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.062 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.062 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 25998853806074907922736536937144192810524126200249845203941498583957653002742012081024851371701765572997964410773213417627351163207763916839110493186842727422105108695847327425148517951272422220366166787137233228070807559064518855586460848701406111149789270506162893565711430566183449983164245901187970559589037577615433138971451632097660130400984021863805390812022721378617499178820332971373486312850645816708350643062789774826141511451391051956832621350686324922826347973370110492133155768037641842259670336438666133242469461046538870604952985498558023280525040790594650803517622806143906741297205357832508919936977
  public exponent: 65537
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;GHtdQZgXMcB7FhYuBxHtpT4zMh1MgjH/Tr16nGjxaN8=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - verify 1 References
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - I am not requested to follow nested Manifests
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;null&quot;)
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;null&quot;)
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.063 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.064 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.064 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.053Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.052Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.064 [Test worker] DEBUG org.apache.xml.security.signature.Reference - Verification successful for URI &quot;#some-assertion-id&quot;
14:58:09.064 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - The Reference has Type 
14:58:09.064 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature validated with key from supplied credential
14:58:09.064 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate credential was successful
14:58:09.064 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Successfully verified signature using resolved trusted credential
14:58:09.067 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:09.067 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:09.067 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:09.067 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:09.067 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:09.068 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:09.068 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:09.068 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:09.068 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:09.068 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:09.068 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:09.068 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:09.068 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:09.068 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;&quot;)
14:58:09.068 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.068 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;&quot;)
14:58:09.068 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.068 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Signature contained 1 ds:Object child element(s)
14:58:09.072 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:09.072 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:09.072 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:09.072 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:09.072 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:09.072 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:09.072 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:09.072 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:09.072 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:09.072 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:09.072 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:09.073 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Signature SignedInfo had invalid number of References: 2
14:58:09.076 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:09.076 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:09.076 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:09.076 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:09.076 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:09.076 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:09.076 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:09.076 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:09.076 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:09.076 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:09.076 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:09.077 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:09.077 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:09.077 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - SignableSAMLObject did not contain an ID attribute
14:58:09.080 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:09.080 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:09.080 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:09.080 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:09.080 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:09.080 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:09.080 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:09.080 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:09.080 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:09.080 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:09.080 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:09.081 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:09.081 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:09.081 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;&quot;)
14:58:09.081 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.081 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Signature was missing the required Enveloped signature transform
14:58:09.084 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:09.084 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:09.086 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.086 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.087 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.087 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256&quot;
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.087 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature&quot;
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformC14NExclusive&quot;
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.087 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.087 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.087 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.088 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.088 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.086Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.085Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.088 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.089 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;H6+tQXi8rxKMvn8hzoceFPDlPOsXNtGENn1wMV9iWKQ=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.090 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.090 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.090 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.090 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.091 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.091 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.091 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.091 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.091 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 25998853806074907922736536937144192810524126200249845203941498583957653002742012081024851371701765572997964410773213417627351163207763916839110493186842727422105108695847327425148517951272422220366166787137233228070807559064518855586460848701406111149789270506162893565711430566183449983164245901187970559589037577615433138971451632097660130400984021863805390812022721378617499178820332971373486312850645816708350643062789774826141511451391051956832621350686324922826347973370110492133155768037641842259670336438666133242469461046538870604952985498558023280525040790594650803517622806143906741297205357832508919936977
  public exponent: 65537
14:58:09.092 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.092 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;H6+tQXi8rxKMvn8hzoceFPDlPOsXNtGENn1wMV9iWKQ=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.092 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate validation credential failed
org.opensaml.xmlsec.signature.support.SignatureException: Unable to evaluate key against signature
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:75)
	at org.opensaml.xmlsec.signature.support.SignatureValidator.validate(SignatureValidator.java:54)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.verifySignature(BaseSignatureTrustEngine.java:242)
	at org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine.doValidate(ExplicitKeySignatureTrustEngine.java:119)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:105)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:62)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:48)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.shouldNotAcceptMissignedAssertions(CredentialFactorySignatureValidatorTest.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.xml.security.signature.XMLSignatureException: Signature length not correct: got 128 but was expecting 256
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:92)
	at org.apache.xml.security.algorithms.SignatureAlgorithm.verify(SignatureAlgorithm.java:301)
	at org.apache.xml.security.signature.XMLSignature.checkSignatureValue(XMLSignature.java:759)
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:70)
	... 55 common frames omitted
Caused by: java.security.SignatureException: Signature length not correct: got 128 but was expecting 256
	at sun.security.rsa.RSASignature.engineVerify(RSASignature.java:189)
	at java.security.Signature$Delegate.engineVerify(Signature.java:1223)
	at java.security.Signature.verify(Signature.java:656)
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:90)
	... 58 common frames omitted
14:58:09.092 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Failed to verify signature using either KeyInfo-derived or directly trusted credentials
14:58:09.096 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.096 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.097 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.097 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256&quot;
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.097 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature&quot;
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformC14NExclusive&quot;
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.097 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.097 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.097 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.098 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.098 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.096Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.095Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.098 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.099 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;zrTl4mtQtfMw9FuAEeAQ2IDYKQiQlMUNOep010QYCFs=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.103 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.103 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.103 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.103 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.104 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.104 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.104 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.104 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 25998853806074907922736536937144192810524126200249845203941498583957653002742012081024851371701765572997964410773213417627351163207763916839110493186842727422105108695847327425148517951272422220366166787137233228070807559064518855586460848701406111149789270506162893565711430566183449983164245901187970559589037577615433138971451632097660130400984021863805390812022721378617499178820332971373486312850645816708350643062789774826141511451391051956832621350686324922826347973370110492133155768037641842259670336438666133242469461046538870604952985498558023280525040790594650803517622806143906741297205357832508919936977
  public exponent: 65537
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;zrTl4mtQtfMw9FuAEeAQ2IDYKQiQlMUNOep010QYCFs=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - verify 1 References
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - I am not requested to follow nested Manifests
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;null&quot;)
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;null&quot;)
14:58:09.105 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.096Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.095Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.signature.Reference - Verification successful for URI &quot;#some-assertion-id&quot;
14:58:09.106 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - The Reference has Type 
14:58:09.106 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature validated with key from supplied credential
14:58:09.106 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate credential was successful
14:58:09.106 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Successfully verified signature using resolved trusted credential
14:58:09.107 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.107 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.108 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.108 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256&quot;
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.108 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature&quot;
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformC14NExclusive&quot;
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.108 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.108 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.108 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.109 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.109 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.107Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.106Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.109 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;oSfUOpFrfDWmQCe4mhFcMBzBk8N4kzZnAZKR/V0BvRs=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.115 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.115 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.115 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.115 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.115 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.116 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.116 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.116 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.116 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 25998853806074907922736536937144192810524126200249845203941498583957653002742012081024851371701765572997964410773213417627351163207763916839110493186842727422105108695847327425148517951272422220366166787137233228070807559064518855586460848701406111149789270506162893565711430566183449983164245901187970559589037577615433138971451632097660130400984021863805390812022721378617499178820332971373486312850645816708350643062789774826141511451391051956832621350686324922826347973370110492133155768037641842259670336438666133242469461046538870604952985498558023280525040790594650803517622806143906741297205357832508919936977
  public exponent: 65537
14:58:09.116 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.116 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;oSfUOpFrfDWmQCe4mhFcMBzBk8N4kzZnAZKR/V0BvRs=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.116 [Test worker] WARN org.apache.xml.security.signature.XMLSignature - Signature verification failed.
14:58:09.116 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature cryptographic validation not successful
14:58:09.117 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate validation credential failed
org.opensaml.xmlsec.signature.support.SignatureException: Signature cryptographic validation not successful
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:79)
	at org.opensaml.xmlsec.signature.support.SignatureValidator.validate(SignatureValidator.java:54)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.verifySignature(BaseSignatureTrustEngine.java:242)
	at org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine.doValidate(ExplicitKeySignatureTrustEngine.java:119)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:105)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:62)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:48)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.shouldSupportAnEntityWithMultipleSigningCertificates(CredentialFactorySignatureValidatorTest.java:66)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
14:58:09.117 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.117 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.117 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.117 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.117 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.117 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.117 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.117 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.117 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 28467384286610047790193967127304893209875662073359073774942581887283294160411802792536000169074125867401657852845534832793769124538137509051085458992249703565905800716923469070088999833187597827249635751958059531826825548351550672656743291446712694950734859083390405057337382681249786253663803850894222495451772846819106909725348681532555575251254532621460955520037451236754600370663610020100071967450597633410807407856885679555171801752996449368937848292397495047606491311420123124369147269540780582967348884118030902273439053917167556571322555439984456875509620738152097423039916831980190525678318992037010963562067
  public exponent: 65537
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;oSfUOpFrfDWmQCe4mhFcMBzBk8N4kzZnAZKR/V0BvRs=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - verify 1 References
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - I am not requested to follow nested Manifests
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;null&quot;)
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;null&quot;)
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.107Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.106Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.signature.Reference - Verification successful for URI &quot;#some-assertion-id&quot;
14:58:09.118 [Test worker] DEBUG org.apache.xml.security.signature.Manifest - The Reference has Type 
14:58:09.118 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Signature validated with key from supplied credential
14:58:09.118 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate credential was successful
14:58:09.118 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Successfully verified signature using resolved trusted credential
14:58:09.120 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Examining signed object for content references with exclusive canonicalization transform
14:58:09.120 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectSupport - Saw exclusive transform, declaring non-visible namespaces on signed object
14:58:09.120 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Starting to marshall {http://www.w3.org/2000/09/xmldsig#}Signature
14:58:09.120 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating XMLSignature object
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA256&quot;
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA256withRSA
14:58:09.120 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Adding content to XMLSignature.
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformEnvelopedSignature&quot;
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2000/09/xmldsig#enveloped-signature)
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - Create URI &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; class &quot;class org.apache.xml.security.transforms.implementations.TransformC14NExclusive&quot;
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transform - The NodeList is null
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Transforms.addTransform(http://www.w3.org/2001/10/xml-exc-c14n#)
14:58:09.120 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.120 [Test worker] DEBUG org.opensaml.saml.common.SAMLObjectContentReference - Adding list of inclusive namespaces for signature exclusive canonicalization transform
14:58:09.120 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureMarshaller - Creating Signature DOM element
14:58:09.121 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.Signer - Using a signer of implemenation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl
14:58:09.121 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignerProviderImpl - Computing signature over XMLSignature object
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - I was asked to create a ResourceResolver and got 0
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.resolver.ResourceResolver - check resolvability by class org.apache.xml.security.utils.resolver.ResourceResolver
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - State I can resolve reference: &quot;#some-assertion-id&quot;
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.resolver.implementations.ResolverFragment - Try to catch an Element with ID some-assertion-id and Element was [saml2:Assertion: null]
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (0)th http://www.w3.org/2000/09/xmldsig#enveloped-signature transform
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.transforms.Transforms - Perform the (1)th http://www.w3.org/2001/10/xml-exc-c14n# transform
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - Pre-digested input:
14:58:09.121 [Test worker] DEBUG org.apache.xml.security.utils.DigesterOutputStream - &lt;saml2:Assertion xmlns:saml2=&quot;urn:oasis:names:tc:SAML:2.0:assertion&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; ID=&quot;some-assertion-id&quot; IssueInstant=&quot;2018-04-03T13:58:09.119Z&quot; Version=&quot;2.0&quot; xsi:type=&quot;saml2:AssertionType&quot;&gt;&lt;saml2:Issuer&gt;a-test-entity&lt;/saml2:Issuer&gt;&lt;saml2:Subject xsi:type=&quot;saml2:SubjectType&quot;&gt;&lt;saml2:NameID Format=&quot;urn:oasis:names:tc:SAML:2.0:nameid-format:persistent&quot;&gt;&lt;/saml2:NameID&gt;&lt;saml2:SubjectConfirmation Method=&quot;urn:oasis:names:tc:SAML:2.0:cm:bearer&quot; xsi:type=&quot;saml2:SubjectConfirmationType&quot;&gt;&lt;saml2:SubjectConfirmationData InResponseTo=&quot;default-request-id&quot; NotOnOrAfter=&quot;2018-04-03T14:13:09.119Z&quot; Recipient=&quot;https://signin.service.gov.uk&quot; xsi:type=&quot;saml2:SubjectConfirmationDataType&quot;&gt;&lt;/saml2:SubjectConfirmationData&gt;&lt;/saml2:SubjectConfirmation&gt;&lt;/saml2:Subject&gt;&lt;saml2:Conditions xsi:type=&quot;saml2:ConditionsType&quot;&gt;&lt;saml2:AudienceRestriction xsi:type=&quot;saml2:AudienceRestrictionType&quot;&gt;&lt;saml2:Audience&gt;https://signin.service.gov.uk&lt;/saml2:Audience&gt;&lt;/saml2:AudienceRestriction&gt;&lt;/saml2:Conditions&gt;&lt;/saml2:Assertion&gt;
14:58:09.122 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.122 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;po7eWR2v7TcJGQCBp+EBcSd3wM/IdaPsGhHBy7ocbGo=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.123 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.123 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Enveloped signature transform
14:58:09.123 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;null&quot;)
14:58:09.123 [Test worker] DEBUG org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Saw Exclusive C14N signature transform
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Performing signature algorithm whitelist/blacklist validation using params from CriteriaSet
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/SignatureMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating SignedInfo/Reference/DigestMethod/@Algorithm against whitelist/blacklist: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.SignatureAlgorithmValidator - Validating algorithm URI against whitelist and blacklist: algorithm: http://www.w3.org/2001/04/xmlenc#sha256, whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1], blacklist: []
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm blacklist: []
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed blacklist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Saw non-null algorithm whitelist: [http://www.w3.org/2001/04/xmldsig-more#rsa-sha512, http://www.w3.org/2000/09/xmldsig#sha1, http://www.w3.org/2001/04/xmlenc#sha512, http://www.w3.org/2001/04/xmldsig-more#rsa-sha256, http://www.w3.org/2001/04/xmlenc#sha256, http://www.w3.org/2000/09/xmldsig#rsa-sha1]
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.algorithm.AlgorithmSupport - Algorithm passed whitelist validation: http://www.w3.org/2001/04/xmlenc#sha256
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Attempting to verify signature and establish trust using KeyInfo-derived credentials
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature contained no KeyInfo element, could not resolve verification credentials
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Failed to verify signature and/or establish trust using any KeyInfo-derived credentials
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Attempting to verify signature using trusted credentials
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.123 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.123 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.123 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.123 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.124 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 25998853806074907922736536937144192810524126200249845203941498583957653002742012081024851371701765572997964410773213417627351163207763916839110493186842727422105108695847327425148517951272422220366166787137233228070807559064518855586460848701406111149789270506162893565711430566183449983164245901187970559589037577615433138971451632097660130400984021863805390812022721378617499178820332971373486312850645816708350643062789774826141511451391051956832621350686324922826347973370110492133155768037641842259670336438666133242469461046538870604952985498558023280525040790594650803517622806143906741297205357832508919936977
  public exponent: 65537
14:58:09.124 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.124 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;po7eWR2v7TcJGQCBp+EBcSd3wM/IdaPsGhHBy7ocbGo=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.124 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate validation credential failed
org.opensaml.xmlsec.signature.support.SignatureException: Unable to evaluate key against signature
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:75)
	at org.opensaml.xmlsec.signature.support.SignatureValidator.validate(SignatureValidator.java:54)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.verifySignature(BaseSignatureTrustEngine.java:242)
	at org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine.doValidate(ExplicitKeySignatureTrustEngine.java:119)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:105)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:62)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:48)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.shouldSupportAnEntityWithMultipleSigningCertificates(CredentialFactorySignatureValidatorTest.java:70)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.xml.security.signature.XMLSignatureException: Signature length not correct: got 128 but was expecting 256
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:92)
	at org.apache.xml.security.algorithms.SignatureAlgorithm.verify(SignatureAlgorithm.java:301)
	at org.apache.xml.security.signature.XMLSignature.checkSignatureValue(XMLSignature.java:759)
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:70)
	... 55 common frames omitted
Caused by: java.security.SignatureException: Signature length not correct: got 128 but was expecting 256
	at sun.security.rsa.RSASignature.engineVerify(RSASignature.java:189)
	at java.security.Signature$Delegate.engineVerify(Signature.java:1223)
	at java.security.Signature.verify(Signature.java:656)
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:90)
	... 58 common frames omitted
14:58:09.124 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.SignatureValidationProvider - Using a validation provider of implementation: org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl
14:58:09.124 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Attempting to validate signature using key from supplied credential
14:58:09.124 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Accessing XMLSignature object
14:58:09.125 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validating signature with signature algorithm URI: http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.125 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl - Validation credential key algorithm 'RSA', key instance class 'sun.security.rsa.RSAPublicKeyImpl'
14:58:09.125 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - signatureMethodURI = http://www.w3.org/2001/04/xmldsig-more#rsa-sha256
14:58:09.125 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigAlgorithm    = SHA256withRSA
14:58:09.125 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - jceSigProvider     = SunRsaSign
14:58:09.125 [Test worker] DEBUG org.apache.xml.security.signature.XMLSignature - PublicKey = Sun RSA public key, 2048 bits
  modulus: 28467384286610047790193967127304893209875662073359073774942581887283294160411802792536000169074125867401657852845534832793769124538137509051085458992249703565905800716923469070088999833187597827249635751958059531826825548351550672656743291446712694950734859083390405057337382681249786253663803850894222495451772846819106909725348681532555575251254532621460955520037451236754600370663610020100071967450597633410807407856885679555171801752996449368937848292397495047606491311420123124369147269540780582967348884118030902273439053917167556571322555439984456875509620738152097423039916831980190525678318992037010963562067
  public exponent: 65537
14:58:09.125 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - Canonicalized SignedInfo:
14:58:09.125 [Test worker] DEBUG org.apache.xml.security.utils.SignerOutputStream - &lt;ds:SignedInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;
&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:CanonicalizationMethod&gt;
&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;&gt;&lt;/ds:SignatureMethod&gt;
&lt;ds:Reference URI=&quot;#some-assertion-id&quot;&gt;
&lt;ds:Transforms&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#enveloped-signature&quot;&gt;&lt;/ds:Transform&gt;
&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;/ds:Transform&gt;
&lt;/ds:Transforms&gt;
&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;&gt;&lt;/ds:DigestMethod&gt;
&lt;ds:DigestValue&gt;po7eWR2v7TcJGQCBp+EBcSd3wM/IdaPsGhHBy7ocbGo=&lt;/ds:DigestValue&gt;
&lt;/ds:Reference&gt;
&lt;/ds:SignedInfo&gt;
14:58:09.125 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine - Signature validation using candidate validation credential failed
org.opensaml.xmlsec.signature.support.SignatureException: Unable to evaluate key against signature
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:75)
	at org.opensaml.xmlsec.signature.support.SignatureValidator.validate(SignatureValidator.java:54)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.verifySignature(BaseSignatureTrustEngine.java:242)
	at org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine.doValidate(ExplicitKeySignatureTrustEngine.java:119)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:105)
	at org.opensaml.xmlsec.signature.support.impl.BaseSignatureTrustEngine.validate(BaseSignatureTrustEngine.java:62)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:48)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.shouldSupportAnEntityWithMultipleSigningCertificates(CredentialFactorySignatureValidatorTest.java:70)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.xml.security.signature.XMLSignatureException: Signature length not correct: got 128 but was expecting 256
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:92)
	at org.apache.xml.security.algorithms.SignatureAlgorithm.verify(SignatureAlgorithm.java:301)
	at org.apache.xml.security.signature.XMLSignature.checkSignatureValue(XMLSignature.java:759)
	at org.opensaml.xmlsec.signature.support.provider.ApacheSantuarioSignatureValidationProviderImpl.validate(ApacheSantuarioSignatureValidationProviderImpl.java:70)
	... 55 common frames omitted
Caused by: java.security.SignatureException: Signature length not correct: got 128 but was expecting 256
	at sun.security.rsa.RSASignature.engineVerify(RSASignature.java:189)
	at java.security.Signature$Delegate.engineVerify(Signature.java:1223)
	at java.security.Signature.verify(Signature.java:656)
	at org.apache.xml.security.algorithms.implementations.SignatureBaseRSA.engineVerify(SignatureBaseRSA.java:90)
	... 58 common frames omitted
14:58:09.126 [Test worker] DEBUG org.opensaml.xmlsec.signature.support.impl.ExplicitKeySignatureTrustEngine - Failed to verify signature using either KeyInfo-derived or directly trusted credentials
14:58:09.129 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Starting to unmarshall Apache XML-Security-based SignatureImpl element
14:58:09.129 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Constructing Apache XMLSignature object
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Signature&quot;, &quot;&quot;)
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignedInfo&quot;, &quot;&quot;)
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:SignatureMethod&quot;, &quot;&quot;)
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.algorithms.SignatureAlgorithm - Create URI &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot; class &quot;class org.apache.xml.security.algorithms.implementations.SignatureBaseRSA$SignatureRSASHA1&quot;
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.algorithms.JCEMapper - Request for URI http://www.w3.org/2000/09/xmldsig#rsa-sha1
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.algorithms.implementations.SignatureBaseRSA - Created SignatureRSA using SHA1withRSA
14:58:09.129 [Test worker] DEBUG org.opensaml.xmlsec.signature.impl.SignatureUnmarshaller - Adding canonicalization and signing algorithms, and HMAC output length to Signature
14:58:09.129 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute Format
14:58:09.129 [Test worker] DEBUG org.opensaml.core.xml.io.AbstractXMLObjectUnmarshaller - Ignoring unknown attribute SPNameQualifier
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Reference&quot;, &quot;&quot;)
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transforms&quot;, &quot;&quot;)
14:58:09.129 [Test worker] DEBUG org.apache.xml.security.utils.ElementProxy - setElement(&quot;ds:Transform&quot;, &quot;&quot;)
14:58:09.130 [Test worker] ERROR org.opensaml.saml.security.impl.SAMLSignatureProfileValidator - Error obtaining transform instance
org.apache.xml.security.transforms.TransformationException: Unknown transformation. No handler installed for URI http://www.w3.org/2000/09/xmldsig#invalid
	at org.apache.xml.security.transforms.Transforms.item(Transforms.java:328)
	at org.opensaml.saml.security.impl.SAMLSignatureProfileValidator.validateTransforms(SAMLSignatureProfileValidator.java:228)
	at org.opensaml.saml.security.impl.SAMLSignatureProfileValidator.validateSignatureImpl(SAMLSignatureProfileValidator.java:92)
	at org.opensaml.saml.security.impl.SAMLSignatureProfileValidator.validate(SAMLSignatureProfileValidator.java:64)
	at uk.gov.ida.saml.security.SignatureValidator.validate(SignatureValidator.java:29)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.validateAuthnRequestFile(CredentialFactorySignatureValidatorTest.java:177)
	at uk.gov.ida.saml.security.CredentialFactorySignatureValidatorTest.shouldNotValidateSignatureInvalidEnvelopeTransform(CredentialFactorySignatureValidatorTest.java:162)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.ExpectException.evaluate(ExpectException.java:19)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:78)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:57)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:363)
	at org.mockito.internal.runners.JUnit45AndHigherRunnerImpl.run(JUnit45AndHigherRunnerImpl.java:37)
	at org.mockito.runners.MockitoJUnitRunner.run(MockitoJUnitRunner.java:62)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.runTestClass(JUnitTestClassExecuter.java:114)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassExecuter.execute(JUnitTestClassExecuter.java:57)
	at org.gradle.api.internal.tasks.testing.junit.JUnitTestClassProcessor.processTestClass(JUnitTestClassProcessor.java:66)
	at org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.processTestClass(SuiteTestClassProcessor.java:51)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:32)
	at org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:93)
	at com.sun.proxy.$Proxy1.processTestClass(Unknown Source)
	at org.gradle.api.internal.tasks.testing.worker.TestWorker.processTestClass(TestWorker.java:109)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:35)
	at org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:146)
	at org.gradle.internal.remote.internal.hub.MessageHubBackedObjectConnection$DispatchWrapper.dispatch(MessageHubBackedObjectConnection.java:128)
	at org.gradle.internal.remote.internal.hub.MessageHub$Handler.run(MessageHub.java:404)
	at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:63)
	at org.gradle.internal.concurrent.StoppableExecutorImpl$1.run(StoppableExecutorImpl.java:46)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at org.gradle.internal.concurrent.ThreadFactoryImpl$ManagedThreadRunnable.run(ThreadFactoryImpl.java:55)
	at java.lang.Thread.run(Thread.java:748)
Caused by: org.apache.xml.security.transforms.InvalidTransformException: Unknown transformation. No handler installed for URI http://www.w3.org/2000/09/xmldsig#invalid
	at org.apache.xml.security.transforms.Transform.&lt;init&gt;(Transform.java:157)
	at org.apache.xml.security.transforms.Transforms.item(Transforms.java:326)
	... 55 common frames omitted
</pre>
</span>
</div>
</div>
<div id="footer">
<p>
<div>
<label class="hidden" id="label-for-line-wrapping-toggle" for="line-wrapping-toggle">Wrap lines
<input id="line-wrapping-toggle" type="checkbox" autocomplete="off"/>
</label>
</div>Generated by 
<a href="http://www.gradle.org">Gradle 4.0</a> at 03-Apr-2018 14:58:10</p>
</div>
</div>
</body>
</html>
